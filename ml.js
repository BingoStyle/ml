!function(t,e){function n(t,e){function n(){g||(g=!0,h=t.querySelector("canvas"),u=h.getContext("2d"),v=.13373158940994154,m=.06015722128359704);var e=h.getBoundingClientRect();(h.width!==e.width*w||h.height!==e.height*w)&&(h.width=e.width*w,h.height=e.height*w,f=e.width/2,p=f/15)}function o(){if("spin"===y){n();var t=0;!function(){"spin"===y&&(u.clearRect(0,0,h.width,h.height),u.beginPath(),u.arc(f*w,f*w,(f-p)*w,-v-Math.PI/2-t,-v-Math.PI/2-100*m-t,!0),u.lineWidth=p*w,u.strokeStyle="#ff5000",u.stroke(),u.closePath(),t+=4*Math.PI/60,i(arguments.callee))}()}}function a(t){"draw"===y&&(n(),t>100&&(t=100),u.clearRect(0,0,h.width*w,h.height*w),u.beginPath(),u.arc(f*w,f*w,(f-p)*w,-v-Math.PI/2,-v-Math.PI/2-m*t,!0),u.lineWidth=p*w,u.strokeStyle="#ff5000",u.stroke(),u.closePath())}function s(){var e=t.querySelector(".arrow");e.style.cssText="display: block"}function l(){var e=t.querySelector(".arrow");e.style.webkitTransform="scale(1)",e.style.opacity="1",i(function(){e.style.webkitTransition="-webkit-transform 0.4s ease-in 0, opacity 0.4s ease-in 0",e.style.webkitTransform="scale(0.5)",e.style.opacity="0",e.addEventListener("webkitTransitionEnd",function(){e.removeEventListener("webkitTransitionEnd",arguments.callee),e.style.cssText="display:none;"})})}var c=Date.now()+"-"+ ++r,d=document.createDocumentFragment();1!==arguments.length||arguments[0]instanceof HTMLElement||(e=arguments[0],t=null),t||(t=document.createElement("div"),d.appendChild(t)),e=e||{},t.setAttribute("data-ctrl-name","loading"),t.setAttribute("data-ctrl-id",c),t.innerHTML='<div><canvas></canvas><span class="arrow"></span></div><span class="text"></span>';var h,u,f,p,v,m,g=!1,w=2;Object.defineProperty(this,"bgcolor",{get:function(){return t.style.backgroundColor},set:function(e){if("string"!=typeof e)throw new Error("Non expected value");t.style.backgroundColor=e}}),Object.defineProperty(this,"text",{get:function(){return t.querySelector(".text").innerText},set:function(e){if("string"!=typeof e)throw new Error("Non expected value");var n=t.querySelector("div"),i=t.querySelector(".text");e?(t.style.webkitBoxPack="",n.style.marginLeft="",i.style.display="block",i.innerText=e):(t.style.webkitBoxPack="center",n.style.marginLeft="0",i.style.display="none",i.innerText="")}});var y="";Object.defineProperty(this,"mode",{get:function(){return y},set:function(t){if(!t&&"string"!=typeof t&&["draw","spin"].indexOf(t)<0)throw new Error("Non expected value");y=t,"spin"===y?(x&&l(),o()):"draw"===y&&(s(),a(0))}});var b=0;Object.defineProperty(this,"per",{get:function(){return b},set:function(t){if("draw"!==y)throw new Error('only work under "draw" mode');if(!t&&"number"!=typeof t&&0>t&&t>100)throw new Error("Non expected value");a(t)}});var x="";Object.defineProperty(this,"arrowDirection",{get:function(){return x},set:function(e){if(!e&&"string"!=typeof e&&["up","down",""].indexOf(e)<0)throw new Error("Non expected value");x=e,t.querySelector(".arrow").className="arrow "+e}}),this.remove=function(){t.parentNode&&t.parentNode.removeChild(t)},this.element=t,this.root=d}var i=t.requestAnimationFrame||t.webkitRequestAnimationFrame||function(t){setTimeout(t,1/60*1e3)},r=0;e.loading=n}(window,window.ctrl||(window.ctrl={})),function(t,e){e.tabheader=function(){var t=document.createDocumentFragment(),e=document.createComment("tab-header-begin"),n=document.createComment("tab-header-end");t.appendChild(e),t.appendChild(n),t.insertBefore(this.element=document.createElement("div"),n),this.element.className="tab-header";var i=document.createElement("div");i.className="tab-header-content",i.style.position="relative",i.style.textWrap="nowrap",this.element.appendChild(i);var r,o=lib.scroll(i,{direction:"x"});this.renderSelected=function(){r=document.createElement("div"),i.appendChild(r),r.className="indicator",this.updateSelected()},this.updateSelected=function(t){{var e=i.childNodes[a];e.getBoundingClientRect().width}r.style.width=e.getBoundingClientRect().width+"px",r.style.left=e.offsetLeft+"px",r.style.position="absolute",r.style.bottom="0",r.style.webkitTransitionDuration=Math.abs(.1*t).toFixed(1)+"s",o.scrollToElement(e,!0)},t.remove=function(){if(t.childNodes.length){var i=document.createRange();i.setStartBefore(e),i.setEndAfter(n),t.appendChild(i.extractContents())}};var a=0;Object.defineProperty(this,"selected",{get:function(){return a},set:function(e){if(a!=e){var n=document.createEvent("HTMLEvents");n.initEvent("select",!0,!0),n.selected=s[e],n.selectIndex=e,t.dispatchEvent(n);var i=a-e;return a=e,this.updateSelected(i),a}}});var s=null;Object.defineProperty(this,"viewModel",{get:function(){return s},set:function(t){i.innerHTML="";for(var e=this,n=0;n<t.length;n++){var r=document.createElement("span");r.innerText=t[n].text,i.appendChild(r),r.addEventListener("click",function(t){return function(){e.selected=t}}(n),!1)}this.renderSelected();var a=document.createRange();return a.setStartBefore(i),a.setEndAfter(i),i.style.width=a.getBoundingClientRect().width+"px",o.init(),o.refresh(),s=t}}),this.addEventListener=function(){t.addEventListener.apply(t,arguments)},this.removeEventListener=function(){t.removeEventListener.apply(t,arguments)},this.root=t}}(window,window.ctrl||(window.ctrl={})),function(t,e){function n(t,n){function r(t){var e=document.createEvent("HTMLEvents");e.initEvent("switch",!0,!0),e.panel=t.selected.panel,e.selected=t.selected,e.selectedIndex=t.selectedIndex,a.dispatchEvent(e),Array.prototype.forEach.call(l.querySelectorAll(".panel"),function(t){t.style.display="none"}),t.selected.panel.style.display=""}var o=Date.now()+"-"+ ++i,a=document.createDocumentFragment();if(1!==arguments.length||arguments[0]instanceof HTMLElement||(n=arguments[0],t=null),t||(t=document.createElement("div")),n=n||{},n.header instanceof HTMLElement)var s=new e.tabheader(n.header);else if(n.header instanceof e.tabheader)var s=n.header;else var s=new e.tabheader;var l=document.createElement("div");t.appendChild(s.root),t.appendChild(l),t.setAttribute("data-ctrl-name","tabpanel"),t.setAttribute("data-ctrl-id",o),a.appendChild(t);var c=[];Object.defineProperty(this,"viewModel",{get:function(){return c},set:function(t){if(!t)throw new Error("Non expected value");c=t,this.syncViewModel()}}),s.addEventListener("select",r,!0),this.syncViewModel=function(){var t=c.slice();l.innerHTML="";for(var e=document.createDocumentFragment(),n=0;n<t.length;n++){var i=t[n].panel=document.createElement("div");i.className="panel",i.style.display="none",i.innerHTML=t[n].html||"",e.appendChild(t[n].panel)}l.appendChild(e),s.viewModel=t,r({selected:t[0],selectIndex:0})},this.addEventListener=function(){a.addEventListener.apply(a,arguments)},this.removeEventListener=function(){a.removeEventListener.apply(a,arguments)},this.remove=function(){t.parentNode&&t.parentNode.removeChild(t)},this.element=t,this.root=a}var i=0;e.tabpanel=n}(window,window.ctrl||(window.ctrl={})),function(t,e){function n(t,e){function n(){var e;switch(d){case"column":e=new Array(f+1).join('<div class="column" style="margin-right:'+p+'px;-webkit-box-flex:1;"></div>');break;case"adaptive":var n=Math.floor((t.getBoundingClientRect().width+p)/(u+p));e=new Array(n+1).join('<div class="column" style="width:'+u+"px;margin-right:"+p+'px;"></div>');break;case"fix":e=new Array(f+1).join('<div class="column" style="width:'+u+"px;margin-right:"+p+'px;"></div>')}c.innerHTML=e,c.style.height="",w=Array.prototype.slice.call(c.querySelectorAll(".column")).map(function(t){return t.height=0,t.items={},t.fragment=document.createDocumentFragment(),t})}function r(t){for(var e=w[0],n=e.height,i=1;i<w.length;i++){var r=w[i].height||0;n>r&&(e=w[i],n=r)}var o=e.fragment;t.style.webkitTransform="translateY("+e.height+"px)",o.appendChild(t),t.height||e.appendChild(o),e.height=(e.height||0)+(t.height||t.getBoundingClientRect().height)+v}function o(){for(;m<g.length;m++){var t=g[m],e=document.createElement("div");e.className="item",t.width&&(e.width=t.width,e.style.width=t.width+"px"),t.height&&(e.height=t.height,e.style.height=t.height+"px"),e.innerHTML=t.html,r(e)}for(var n=0,i=0;i<w.length;i++)w[i].fragment&&w[i].fragment.childElementCount&&w[i].appendChild(w[i].fragment),n=Math.max(n,w[i].height);c.style.height=n+"px"}var a=this,s=Date.now()+"-"+ ++i,l=document.createDocumentFragment();1!==arguments.length||arguments[0]instanceof HTMLElement||(e=arguments[0],t=null),t||(t=document.createElement("div"),l.appendChild(t)),e=e||{},t.setAttribute("data-ctrl-name","waterfall"),t.setAttribute("data-ctrl-id",s);var c=document.createElement("div");c.className="column-wrap",t.appendChild(c);var d,h=!0;Object.defineProperty(this,"mode",{get:function(){return d},set:function(t){if(["column","adaptive","fix"].indexOf(t)<0)throw new Error("Non expected value");d!==t&&(h=!0,d=t)}}),this.mode=e.mode||"column";var u;Object.defineProperty(this,"columnWidth",{get:function(){var t=c.querySelector(".column");return t?t.getBoundingClientRect().width:u||0},set:function(t){if("string"==typeof t){var e=parseInt(t);if(!e)throw new Error("Non expected value");u=e}else{if("number"!=typeof t)throw new Error("Non expected value");u=t}}}),e.columnWidth&&(this.columnWidth=e.columnWidth);var f;Object.defineProperty(this,"columnAmount",{get:function(){var t=c.querySelectorAll(".column");return t&&t.length?t.length:f||0},set:function(t){if("string"==typeof t){var e=parseInt(t);if(!e)throw new Error("Non expected value");f=e}else{if("number"!=typeof t)throw new Error("Non expected value");f=t}}}),e.columnAmount&&(this.columnAmount=e.columnAmount);var p;Object.defineProperty(this,"columnPadding",{get:function(){return p},set:function(t){if("string"==typeof t){var e=parseInt(t);if(!e)throw new Error("Non expected value");p=e}else{if("number"!=typeof t)throw new Error("Non expected value");p=t}}}),e.columnPadding&&(this.columnPadding=e.columnPadding);var v;Object.defineProperty(this,"linePadding",{get:function(){return v},set:function(t){if("string"==typeof t){var e=parseInt(t);if(!e)throw new Error("Non expected value");v=e}else{if("number"!=typeof t)throw new Error("Non expected value");v=t}}}),e.linePadding&&(this.linePadding=e.linePadding||0);var m=0,g=[];Object.defineProperty(this,"viewModel",{get:function(){return g},set:function(t){if(!(t instanceof Array))throw new Error("Non expected value");g=t,a.syncViewModel("refresh")}});var w;this.syncViewModel=function(t){t=t||"padding","refresh"===t||h?(refresh=!1,m=0,n(),o()):"padding"===t&&o()},this.addEventListener=function(){t.addEventListener.apply(t,arguments)},this.removeEventListener=function(){t.removeEventListener.apply(t,arguments)},this.remove=function(){t.parentNode&&t.parentNode.removeChild(t)},this.element=t,this.root=l,n()}var i=0;e.waterfall=n}(window,window.ctrl||(window.ctrl={})),function(t){function e(t,e){for(var n=t;n;){if(n.contains(e)||n==e)return n;n=n.parentNode}return null}function n(t,e,n){var i=l.createEvent("HTMLEvents");if(i.initEvent(e,!0,!0),"object"==typeof n)for(var r in n)i[r]=n[r];t.dispatchEvent(i)}function i(t,e,n,i,r,o,a,s){var l=Math.atan2(s-o,a-r)-Math.atan2(i-e,n-t),c=Math.sqrt((Math.pow(s-o,2)+Math.pow(a-r,2))/(Math.pow(i-e,2)+Math.pow(n-t,2))),d=[r-c*t*Math.cos(l)+c*e*Math.sin(l),o-c*e*Math.cos(l)-c*t*Math.sin(l)];return{rotate:l,scale:c,translate:d,matrix:[[c*Math.cos(l),-c*Math.sin(l),d[0]],[c*Math.sin(l),c*Math.cos(l),d[1]],[0,0,1]]}}function r(t){0===Object.keys(h).length&&(c.addEventListener("touchmove",o,!1),c.addEventListener("touchend",a,!1),c.addEventListener("touchcancel",s,!1));for(var i=0;i<t.changedTouches.length;i++){var r=t.changedTouches[i],l={};for(var u in r)l[u]=r[u];var f={startTouch:l,startTime:Date.now(),status:"tapping",element:t.srcElement,pressingHandler:setTimeout(function(e){return function(){"tapping"===f.status&&(f.status="pressing",n(e,"press",{touchEvent:t})),clearTimeout(f.pressingHandler),f.pressingHandler=null}}(t.srcElement),500)};h[r.identifier]=f}if(2==Object.keys(h).length){var p=[];for(var u in h)p.push(h[u].element);n(e(p[0],p[1]),"dualtouchstart",{touches:d.call(t.touches),touchEvent:t})}}function o(t){for(var r=0;r<t.changedTouches.length;r++){var o=t.changedTouches[r],a=h[o.identifier];if(!a)return;a.lastTouch||(a.lastTouch=a.startTouch),a.lastTime||(a.lastTime=a.startTime),a.velocityX||(a.velocityX=0),a.velocityY||(a.velocityY=0),a.duration||(a.duration=0);var s=Date.now()-a.lastTime,l=(o.clientX-a.lastTouch.clientX)/s,c=(o.clientY-a.lastTouch.clientY)/s,d=70;s>d&&(s=d),a.duration+s>d&&(a.duration=d-s),a.velocityX=(a.velocityX*a.duration+l*s)/(a.duration+s),a.velocityY=(a.velocityY*a.duration+c*s)/(a.duration+s),a.duration+=s,a.lastTouch={};for(var u in o)a.lastTouch[u]=o[u];a.lastTime=Date.now();var f=o.clientX-a.startTouch.clientX,p=o.clientY-a.startTouch.clientY,v=Math.sqrt(Math.pow(f,2)+Math.pow(p,2));"tapping"===a.status&&v>10&&(a.status="panning",a.isVertical=!(Math.abs(f)>Math.abs(p)),n(a.element,"panstart",{touch:o,touchEvent:t,isVertical:a.isVertical}),n(a.element,(a.isVertical?"vertical":"horizontal")+"panstart",{touch:o,touchEvent:t})),"panning"===a.status&&(a.panTime=Date.now(),n(a.element,"pan",{displacementX:f,displacementY:p,touch:o,touchEvent:t,isVertical:a.isVertical}),a.isVertical?n(a.element,"verticalpan",{displacementY:p,touch:o,touchEvent:t}):n(a.element,"horizontalpan",{displacementX:f,touch:o,touchEvent:t}))}if(2==Object.keys(h).length){for(var m,g=[],w=[],y=[],r=0;r<t.touches.length;r++){var o=t.touches[r],a=h[o.identifier];g.push([a.startTouch.clientX,a.startTouch.clientY]),w.push([o.clientX,o.clientY])}for(var u in h)y.push(h[u].element);m=i(g[0][0],g[0][1],g[1][0],g[1][1],w[0][0],w[0][1],w[1][0],w[1][1]),n(e(y[0],y[1]),"dualtouch",{transform:m,touches:t.touches,touchEvent:t})}}function a(t){if(2==Object.keys(h).length){var i=[];for(var r in h)i.push(h[r].element);n(e(i[0],i[1]),"dualtouchend",{touches:d.call(t.touches),touchEvent:t})}for(var l=0;l<t.changedTouches.length;l++){var f=t.changedTouches[l],p=f.identifier,v=h[p];if(v){if(v.pressingHandler&&(clearTimeout(v.pressingHandler),v.pressingHandler=null),"tapping"===v.status&&(v.timestamp=Date.now(),n(v.element,"tap",{touch:f,touchEvent:t}),u&&v.timestamp-u.timestamp<300&&n(v.element,"doubletap",{touch:f,touchEvent:t}),u=v),"panning"===v.status){var m=Date.now()-v.startTime,g=((f.clientX-v.startTouch.clientX)/m,(f.clientY-v.startTouch.clientY)/m,f.clientX-v.startTouch.clientX),w=f.clientY-v.startTouch.clientY,y=Math.sqrt(v.velocityY*v.velocityY+v.velocityX*v.velocityX),b=Date.now(),x=y>.5&&b-(v.lastTime<10);n(v.element,"panend",{isflick:x,touch:f,touchEvent:t,isVertical:v.isVertical}),x&&(n(v.element,"flick",{duration:m,velocityX:v.velocityX,velocityY:v.velocityY,displacementX:g,displacementY:w,touch:f,touchEvent:t,isVertical:v.isVertical}),v.isVertical?n(v.element,"verticalflick",{duration:m,velocityY:v.velocityY,displacementY:w,touch:f,touchEvent:t}):n(v.element,"horizontalflick",{duration:m,velocityX:v.velocityX,displacementX:g,touch:f,touchEvent:t}))}"pressing"===v.status&&n(v.element,"pressend",{touch:f,touchEvent:t}),delete h[p]}}0===Object.keys(h).length&&(c.removeEventListener("touchmove",o,!1),c.removeEventListener("touchend",a,!1),c.removeEventListener("touchcancel",s,!1))}function s(t){if(2==Object.keys(h).length){var i=[];for(var r in h)i.push(h[r].element);n(e(i[0],i[1]),"dualtouchend",{touches:d.call(t.touches),touchEvent:t})}for(var l=0;l<t.changedTouches.length;l++){var u=t.changedTouches[l],f=u.identifier,p=h[f];p&&(p.pressingHandler&&(clearTimeout(p.pressingHandler),p.pressingHandler=null),"panning"===p.status&&n(p.element,"panend",{touch:u,touchEvent:t}),"pressing"===p.status&&n(p.element,"pressend",{touch:u,touchEvent:t}),delete h[f])}0===Object.keys(h).length&&(c.removeEventListener("touchmove",o,!1),c.removeEventListener("touchend",a,!1),c.removeEventListener("touchcancel",s,!1))}var l=t.document,c=l.documentElement,d=Array.prototype.slice,h={},u=null;c.addEventListener("touchstart",r,!1)}(window,window.lib||(window.lib={})),function(t,e){function n(t){if(this.v=t.v||0,this.a=t.a||0,"undefined"!=typeof t.t&&(this.t=t.t),"undefined"!=typeof t.s&&(this.s=t.s),"undefined"==typeof this.t)if("undefined"==typeof this.s)this.t=-this.v/this.a;else{var e=(Math.sqrt(this.v*this.v+2*this.a*this.s)-this.v)/this.a,n=(-Math.sqrt(this.v*this.v+2*this.a*this.s)-this.v)/this.a;this.t=Math.min(e,n)}"undefined"==typeof this.s&&(this.s=this.a*this.t*this.t/2+this.v*this.t),this.generateCubicBezier=function(){function t(t,e){return[[(t/3+(t+e)/3-t)/(e-t),(t*t/3+t*e*2/3-t*t)/(e*e-t*t)],[(e/3+(t+e)/3-t)/(e-t),(e*e/3+t*e*2/3-t*t)/(e*e-t*t)]]}return t(this.v/this.a,this.t+this.v/this.a)}}e.motion=n}(window,window.lib||(window.lib={})),function(t,e){function n(t){t=t||"";var e=this,n={};if(t&&"string"==typeof t)for(var i=t.split("&"),r=0;r<i.length;r++){var o=i[r].split("=");n[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}else if("object"==typeof t)for(var a in t)n[a]=t[a];for(var a in n)!function(t){Object.defineProperty(e,t,{get:function(){return n[t]},set:function(e){n[t]=e},enumerable:!0})}(a);this.toString=function(){return Object.keys(n).sort().map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(n[t])}).join("&")}}function i(){function e(t){var e=r.createElement("a");e.href=t;var n=r.createEvent("HTMLEvents");n.initEvent("click",!1,!0),e.dispatchEvent(n)}function i(t,e){var n=r.createEvent("HTMLEvents");if(n.initEvent(t,!1,!1),e)for(var i in e)n[i]=e[i];window.dispatchEvent(n)}function l(){this.exec=function(){i("navigation:push")}}function c(){this.exec=function(){i("navigation:pop")}}function d(){this.exec=function(){i("navigation:replace")}}function h(t,e){return t.name===e.name&&t.args.toString()===e.args.toString()}var u=this,f=[],p=!1,v=!!a.state,m={},g="initial";f.ensureStart=function(){p||(p=!0,s(function(){f.length&&f.shift().exec(),s(arguments.callee)}))},this.push=function(t,r){var o={name:t,args:new n(r),id:m.state.id+1};if(!h(o,m.state)){g="push";var s=o.args.toString();if(v){var l="#"+o.name+(s?"?"+s:"");a.pushState({name:o.name,args:s,id:o.id},null,l),i("pushstate")}else{var l="#"+o.name+"["+o.id+"]"+(s?"?"+s:"");e(l)}}},this.pop=function(){m.state.id>1&&(g="pop",a.back())},this.replace=function(t,r){var o={name:t,args:new n(r),id:m.state.id};if(!h(o,m.state)){g="replace";var s=o.args.toString();if(v){var l="#"+o.name+(s?"?"+s:"");a.replaceState({name:o.name,args:s,id:o.id},null,l),i("replacestate")}else{var l="#"+o.name+"["+o.id+"]"+(s?"?"+s:"");e(l)}}};var w=!1;this.start=function(e){function i(){var t;if(v&&"object"==typeof a.state)t={id:a.state.id,name:a.state.name,args:new n(a.state.args)};else{var e=o.hash,i=e.match(/#([^\[\]\?]+)(?:\[(\d+)\])?(?:\?(.*))?/)||["",s,1,h];t={name:i[1],id:parseInt(i[2]||1),args:new n(i[3]||"")}}return t}function r(){var t=i(),e=m.state;m.state=t,t.id<e.id?(g="pop",f.push(new c(t,t.id-e.id))):t.id===e.id?"replace"===u.action&&f.push(new d(t)):(g="push",f.push(new l(t,t.id-e.id)))}if(!w){w=!0;var s=e.defaultPath||"",h=e.defaultArgs||"";v&=!!e.useHistoryState,Object.defineProperty(this,"useHistoryState",{get:function(){return v}}),Object.defineProperty(this,"action",{get:function(){return g}}),Object.defineProperty(this,"state",{get:function(){return{id:m.state.id,name:m.state.name,args:m.state.args}}});var p=i();v?(t.addEventListener("pushstate",r,!1),t.addEventListener("popstate",r,!1),t.addEventListener("replacestate",r,!1)):t.addEventListener("hashchange",r,!1),m.state=p,f.push(new l(p)),f.ensureStart()}}}var r=t.document,o=t.location,a=t.history;a.replaceState&&a.replaceState(!0);var s=window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(t){setTimeout(t,1/60)};e.navigation=i}(window,window.lib||(window.lib={})),function(t,e){function n(){e.scroll.outputDebugLog&&console.debug.apply(console,arguments)}function i(t){var e=t.getBoundingClientRect();if(!e){e={},e.width=t.offsetWidth,e.height=t.offsetHeight,e.left=t.offsetLeft,e.top=t.offsetTop;for(var n=t.offsetParent;n;)e.left+=n.offsetLeft,e.top+=n.offsetTop,n=n.offsetParent;e.right=e.left+e.width,e.bottom=e.top+e.height}return e}function r(t){return 0-t.options[t.axis+"Padding1"]}function o(t){var e=i(t.element),n=i(t.viewport),o=r(t);if("y"===t.axis)var a=0-e.height+n.height;else var a=0-e.width+n.width;return Math.min(a+t.options[t.axis+"Padding2"],o)}function a(t,e){return e>t.minScrollOffset?e-t.minScrollOffset:e<t.maxScrollOffset?e-t.maxScrollOffset:void 0}function s(t,e){return e>t.minScrollOffset?e=t.minScrollOffset:e<t.maxScrollOffset&&(e=t.maxScrollOffset),e}function l(t,e,i){n(t.element.scrollId,e,i);var r=u.createEvent("HTMLEvents");if(r.initEvent(e,!1,!0),r.scrollObj=t,i)for(var o in i)r[o]=i[o];t.element.dispatchEvent(r),t.viewport.dispatchEvent(r)}function c(t){var e,n={x:0,y:0},i=getComputedStyle(t.element).webkitTransform;return"none"!==i&&(e=i.match(/^matrix3d\(\d+, \d+, \d+, \d+, \d+, \d+, \d+, \d+, \d+, \d+, \d+, \d+, ([-\d.]+), ([-\d.]+), [-\d.]+, \d+\)/)||i.match(/^matrix\(\d+, \d+, \d+, \d+, ([-\d.]+), ([-\d.]+)\)$/))&&(n.x=parseInt(e[1])||0,n.y=parseInt(e[2])||0),n}function d(t,e){return g?"translate3d("+t+"px, "+e+"px, 0)":"translate("+t+"px, "+e+"px)"}function h(t,e){function h(t){return t.preventScrollendClick=C,C?(t.preventDefault(),t.stopPropagation(),!1):!0}function g(t,e){O=null,clearTimeout(H),H=setTimeout(function(){O&&(O=null,w(t))},e||400),O=t}function b(){M.enabled&&(j&&L(),t.style.webkitBackfaceVisibility="hidden",t.style.webkitTransformStyle="preserve-3d",t.style.webkitTransform=getComputedStyle(t).webkitTransform,t.style.webkitTransition="",O=null,clearTimeout(H))}function x(){if(M.enabled){var e=c(M)[M.axis],n=a(M,e);if(""===t.style.webkitTransition&&n){var i=s(M,e);n>0?l(M,"y"===M.axis?"pulldownend":"pullrightend"):0>n&&l(M,"y"===M.axis?"pullupend":"pullleftend"),t.style.webkitTransition="-webkit-transform 0.4s ease 0",t.style.webkitTransform="translate"+M.axis.toUpperCase()+"("+i.toFixed(0)+"px)",g(L,400),M.fireScrollingEvent&&w(function(){j&&M.enabled&&(l(M,"scrolling"),w(arguments.callee))})}else j&&L()}}function E(t){M.enabled&&("y"!==M.axis&&t.isVertical||"x"===M.axis&&t.isVertical||(M.transformOffset=c(M),M.minScrollOffset=r(M),M.maxScrollOffset=o(M),N=2.5,A=!0,j=!0,F=!1,l(M,"scrollstart"),V=t["displacement"+M.axis.toUpperCase()]))}function T(e){if(M.enabled&&("y"===M.axis&&e.isVertical||"x"===M.axis&&!e.isVertical)){e.stopPropagation();var n=e["displacement"+M.axis.toUpperCase()];if(Math.abs(n-V)<5)return void e.stopPropagation();V=n;var i=M.transformOffset[M.axis]+n;i>M.minScrollOffset?(i=M.minScrollOffset+(i-M.minScrollOffset)/N,N*=1.003):i<M.maxScrollOffset&&(i=M.maxScrollOffset-(M.maxScrollOffset-i)/N,N*=1.003),N>4&&(N=4);var r=a(M,i);r&&(l(M,r>0?"y"===M.axis?"pulldown":"pullright":"y"===M.axis?"pullup":"pullleft",{boundaryOffset:Math.abs(r)}),M.options.noBounce&&(i=s(M,i))),t.style.webkitTransition="",t.style.webkitTransform="y"===M.axis?d(M.transformOffset.x,i):d(i,M.transformOffset.y),M.fireScrollingEvent&&l(M,"scrolling")}}function S(t){M.enabled&&("y"!==M.axis&&t.isVertical||"x"===M.axis&&t.isVertical)}function k(i){if(M.enabled&&("y"===M.axis&&i.isVertical||"x"===M.axis&&!i.isVertical)){i.stopPropagation(),A=!0;var r,o,d,h,u,p,v,y,b,x,E,T,S,k,P,C,O;h=c(M)[M.axis];var H=a(M,h);if(!H){r=i["velocity"+M.axis.toUpperCase()];var N=2,V=.0015;e.inertia&&m[e.inertia]&&(N=m[e.inertia][0],V=m[e.inertia][1]),r>N&&(r=N),-N>r&&(r=-N),o=V*(r/Math.abs(r)),p=f({v:r,a:-o}),d=p.t,u=h+p.s;var I=a(M,u);if(I)n("惯性计算超出了边缘",I),e.noBounce?(n("没有回弹效果"),x=s(M,u),h!==x?(t.style.webkitTransition="-webkit-transform 0.4s ease-out 0",t.style.webkitTransform="translate"+M.axis.toUpperCase()+"("+x.toFixed(0)+"px)",g(L,400)):L()):(v=r,y=o,I>0?(x=M.minScrollOffset,T=1):(x=M.maxScrollOffset,T=-1),E=f({v:T*v,a:-T*y,s:Math.abs(x-h)}),b=E.t,S=v-y*b,k=.03*(S/Math.abs(S)),O=f({v:S,a:-k}),P=O.t,C=x+O.s,n("惯性滚动","s="+C.toFixed(0),"t="+((b+P)/1e3).toFixed(2)),h!==C?(t.style.webkitTransition="-webkit-transform "+((b+P)/1e3).toFixed(2)+"s ease-out 0",t.style.webkitTransform="translate"+M.axis.toUpperCase()+"("+C.toFixed(0)+"px)",g(function(){M.enabled&&(n("惯性回弹","s="+x.toFixed(0),"t=400"),C!==x?(t.style.webkitTransition="-webkit-transform 0.4s ease 0",t.style.webkitTransform="translate"+M.axis.toUpperCase()+"("+x.toFixed(0)+"px)",g(L,400)):L())},1e3*((b+P)/1e3).toFixed(2))):L());else{n("惯性计算没有超出了边缘");var Y=p.generateCubicBezier();t.style.webkitTransition="-webkit-transform "+(d/1e3).toFixed(2)+"s cubic-bezier("+Y+") 0",t.style.webkitTransform="translate"+M.axis.toUpperCase()+"("+u.toFixed(0)+"px)",g(L,1e3*(d/1e3).toFixed(2))}M.fireScrollingEvent&&(F=!0,w(function(){j&&F&&M.enabled&&(l(M,"scrolling",{afterFlick:!0}),w(arguments.callee))}))}}}function L(){M.enabled&&(A=!1,setTimeout(function(){!A&&j&&(j=!1,F=!1,t.style.webkitTransition="",l(M,"scrollend"))},50))}var M=this;if(e=e||{},e.noBounce=!!e.noBounce,e.padding=e.padding||{},e.isPrevent=null==e.isPrevent?!0:!!e.isPrevent,e.isFixScrollendClick=null==e.isFixScrollendClick?!0:!!e.isFixScrollendClick,e.padding?(e.yPadding1=-e.padding.top||0,e.yPadding2=-e.padding.bottom||0,e.xPadding1=-e.padding.left||0,e.xPadding2=-e.padding.right||0):(e.yPadding1=0,e.yPadding2=0,e.xPadding1=0,e.xPadding2=0),e.margin?(e.yMargin1=-e.margin.top||0,e.yMargin2=-e.margin.bottom||0,e.xMargin1=-e.margin.left||0,e.xMargin2=-e.margin.right||0):(e.yMargin1=0,e.yMargin2=0,e.xMargin1=0,e.xMargin2=0),e.direction=e.direction||"y",e.inertia=e.inertia||"normal",this.options=e,M.axis=e.direction,this.element=t,this.viewport=t.parentNode,this.plugins={},this.viewport.addEventListener("touchstart",b,!1),this.viewport.addEventListener("touchend",x,!1),this.viewport.addEventListener("touchcancel",x,!1),this.viewport.addEventListener("panstart",E,!1),this.viewport.addEventListener("pan",T,!1),this.viewport.addEventListener("panend",S,!1),this.viewport.addEventListener("flick",k,!1),this.element.scrollId=setTimeout(function(){p[M.element.scrollId+""]=M},1),e.isPrevent){var P="y"===this.axis?"vertical":"horizontal";this.viewport.addEventListener(P+"panstart",function(){y=!0},!1),M.viewport.addEventListener("panend",function(){y=!1},!1)}if(e.isFixScrollendClick){var C;this.viewport.addEventListener("touchstart",function(){j&&(C=!0)},!1),this.viewport.addEventListener("scrollend",function(){setTimeout(function(){C=!1},400)},!1),this.viewport.addEventListener("click",h,!1),this.viewport.addEventListener("tap",h,!1)}var O,H=0;t.addEventListener("webkitTransitionEnd",function(t){if(O){var e=O;O=null,clearTimeout(H),w(function(){e(t)})}},!1);var N,j,F,A,V,I={init:function(){return this.enable(),this.refresh(),this.scrollTo(0),this},enable:function(){return this.enabled=!0,this},disable:function(){var t=this.element;return this.enabled=!1,w(function(){t.style.webkitTransform=getComputedStyle(t).webkitTransform}),this},getScrollWidth:function(){return i(this.element).width},getScrollHeight:function(){return i(this.element).height},getScrollLeft:function(){return-c(this).x-this.options.xPadding1},getScrollTop:function(){return-c(this).y-this.options.yPadding1},getMaxScrollLeft:function(){return-M.maxScrollOffset-this.options.xPadding1},getMaxScrollTop:function(){return-M.maxScrollOffset-this.options.yPadding1},getBoundaryOffset:function(){return Math.abs(a(this,c(this)[this.axis])||0)},refresh:function(){var t=this.element,e="y"===this.axis,n=e?"height":"width";if(null!=this.options[n])t.style[n]=this.options[n]+"px";else if(t.childElementCount>0){var a,s,d=t.firstElementChild,h=t.lastElementChild;if(document.createRange&&(a=document.createRange(),a.selectNodeContents(t),s=i(a)),s)t.style[n]=s[n]+"px";else if(d&&h){for(;d&&0===i(d)[n]&&d.nextElementSibling;)d=d.nextElementSibling;for(;h&&h!==d&&0===i(h)[n]&&h.previousElementSibling;)h=h.previousElementSibling;t.style[n]=i(h)[e?"bottom":"right"]-i(d)[e?"top":"left"]+"px"}else t.style[n]="0"}else t.style[n]="auto",t.style[n]=i(t)[n]+"px";return this.transformOffset=c(this),this.minScrollOffset=r(this),this.maxScrollOffset=o(this),this.scrollTo(-this.transformOffset[this.axis]-this.options[this.axis+"Padding1"]),l(this,"contentchange"),this},offset:function(t){var e=i(this.element),n=i(t);if("y"===this.axis){var r={top:n.top-e.top-this.options.yPadding1,left:n.left-e.left,right:e.right-n.right,width:n.width,height:n.height};r.bottom=r.top+r.height}else{var r={top:n.top-e.top,bottom:e.bottom-n.bottom,left:n.left-e.left-this.options.xPadding1,width:n.width,height:n.height};r.right=r.left+r.width}return r},getRect:function(t){var e=i(this.viewport),n=i(t);if("y"===this.axis){var r={top:n.top-e.top,left:n.left-e.left,right:e.right-n.right,width:n.width,height:n.height};r.bottom=r.top+r.height}else{var r={top:n.top-e.top,bottom:e.bottom-n.bottom,left:n.left-e.left,width:n.width,height:n.height};r.right=r.left+r.width}return r},isInView:function(t){var e=i(this.viewport),n=this.getRect(t);return"y"===this.axis?e.top<n.bottom&&e.bottom>n.top:e.left<n.right&&e.right>n.left},scrollTo:function(t,e){var n=this.element;return t=-t-this.options[this.axis+"Padding1"],t=s(this,t),e===!0?(n.style.webkitTransition="-webkit-transform 0.4s ease 0",g(L,400)):(n.style.webkitTransition="",g(L,1)),n.style.webkitTransform="y"===this.axis?d(c(this).x,t):d(t,c(this).y),this},scrollToElement:function(t,e){var n=this.offset(t);return n=n["y"===this.axis?"top":"left"],this.scrollTo(n,e)},getViewWidth:function(){return i(this.viewport).width},getViewHeight:function(){return i(this.viewport).height},addPulldownHandler:function(t){var e=this;return this.element.addEventListener("pulldownend",function(n){e.disable(),t(n,function(){e.scrollTo(0,!0),e.enable()})},!1),this},addPullupHandler:function(t){var e=this;return this.element.addEventListener("pullupend",function(n){e.disable(),t(n,function(){e.scrollTo(e.getScrollHeight(),!0),e.enable()})},!1),this},addScrollstartHandler:function(t){return this.element.addEventListener("scrollstart",function(e){t(e)},!1),this},addScrollingHandler:function(t){if(!this.fireScrollingEvent){this.fireScrollingEvent=!0;var e=u.createElement("div");e.className="force-refresh",e.style.cssText="position: absolute; top: 0; left: 0; width: 0; height: 0; font-size: 0; opacity: 1;",this.viewport.appendChild(e),this.element.addEventListener("scrolling",function(){e.style.opacity=Math.abs(parseInt(e.style.opacity)-1)+""},!1)}return this.element.addEventListener("scrolling",function(e){t(e)},!1),this},addScrollendHandler:function(t){return this.element.addEventListener("scrollend",function(e){t(e)},!1),this},addEventListener:function(){this.element.addEventListener.apply(this.element,arguments)},removeEventListener:function(){this.element.removeEventListener.apply(this.element,arguments)},enablePlugin:function(t,e){var n=v[t];return n&&!this.plugins[t]&&(this.plugins[t]=!0,e=e||{},n.call(this,t,e)),this}};for(var Y in I)this[Y]=I[Y];delete I}var u=t.document,f=e.motion,p={},v={},m={normal:[2,.0015],slow:[1.5,.003],veryslow:[1.5,.005]},g="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,w=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(t){setTimeout(t,16)}}(),y=!1;u.addEventListener("touchmove",function(t){return y?(t.preventDefault(),!1):!0},!1),e.scroll=function(t,e){if(1===arguments.length&&!(arguments[0]instanceof HTMLElement))if(e=arguments[0],e.scrollElement)t=e.scrollElement;else{if(!e.scrollWrap)throw new Error("no scroll element");t=e.scrollWrap.firstElementChild}if(!t.parentNode)throw new Error("wrong dom tree");if(e&&e.direction&&["x","y"].indexOf(e.direction)<0)throw new Error("wrong direction");var n;return n=t.scrollId?p[t.scrollId]:new h(t,e)},e.scroll.plugin=function(t,e){return e?(t=t.split(","),void t.forEach(function(t){v[t]=e})):v[t]}}(window,window.lib||(window.lib={}));